---
# yaml-language-server: $schema=https://schema.blue-build.org/module-stage-list-v1.json
modules:
  - type: dnf
    repos:
      files:
        - https://download.docker.com/linux/fedora/docker-ce.repo
    install:
      packages:
        - docker-ce
        - docker-ce-cli
        - containerd.io
        - docker-buildx-plugin
        - docker-compose-plugin
        - docker-model-plugin

  # Copy docker group setup script
  - type: files
    files:
      - source: usr/libexec/dx-docker-groups
        destination: /usr/libexec/dx-docker-groups
        mode: "0755"

  # Enable docker socket and group service
  - type: systemd
    system:
      enabled:
        - docker.socket
        - dx-docker-groups.service
